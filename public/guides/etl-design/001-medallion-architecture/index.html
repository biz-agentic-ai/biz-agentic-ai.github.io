<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>1. 메달리온 아키텍처 - 데이터를 세 겹으로 쌓는 이유 | Junho Lee | DataNexus 구축 과정</title>
<meta name="keywords" content="etl, medallion-architecture, elt">
<meta name="description" content="Bronze, Silver, Gold. 데이터를 레이어별로 나눠서 적재하면 뭐가 달라지는가. DuckDB와 dbt로 직접 구성해 본다.">
<meta name="author" content="Junho Lee">
<link rel="canonical"
    href="https://biz-agentic-ai.github.io/guides/etl-design/001-medallion-architecture/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f02cd38532ee71bc47a8f72d7689b18efbda747f2e684f90cc6f2c90f2311a6b.css" integrity="sha256-8CzThTLucbxHqPctdomxjvvadH8uaE&#43;QzG8skPIxGms="
    rel="preload stylesheet" as="style">
<link rel="icon" href="https://biz-agentic-ai.github.io/favicon.svg">
<link rel="icon" type="image/svg+xml" sizes="16x16" href="https://biz-agentic-ai.github.io/favicon.svg">
<link rel="icon" type="image/svg+xml" sizes="32x32" href="https://biz-agentic-ai.github.io/favicon.svg">
<link rel="apple-touch-icon" href="https://biz-agentic-ai.github.io/favicon.svg">
<link rel="mask-icon" href="https://biz-agentic-ai.github.io/favicon.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://biz-agentic-ai.github.io/guides/etl-design/001-medallion-architecture/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }
    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }
    </style>
</noscript><meta name="author" content="Junho Lee"><meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@biz_agentic_ai">
<meta name="twitter:creator" content="@biz_agentic_ai"><meta name="googlebot" content="index, follow">
<meta name="bingbot" content="index, follow">
<meta name="slurp" content="index, follow"><meta name="language" content="ko">
<meta name="geo.region" content="KR">
<meta name="geo.placename" content="Seoul"><meta property="og:type" content="article">
<meta property="og:site_name" content="Junho Lee | DataNexus 구축 과정">
<meta property="og:locale" content="ko_KR"><script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "1. 메달리온 아키텍처 - 데이터를 세 겹으로 쌓는 이유",
    "description": "Bronze, Silver, Gold. 데이터를 레이어별로 나눠서 적재하면 뭐가 달라지는가. DuckDB와 dbt로 직접 구성해 본다.",
    "image": "",
    "author": {
      "@type": "Person",
      "name": "Junho Lee"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Junho Lee | DataNexus 구축 과정",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/biz-agentic-ai.github.io\/favicon.svg"
      }
    },
    "datePublished": "2026-02-22T10:00:00\u002b09:00",
    "dateModified": "2026-02-22T10:00:00\u002b09:00",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/biz-agentic-ai.github.io\/guides\/etl-design\/001-medallion-architecture\/"
    }
  }
  </script><style>
  :root {
    --sidebar-width: 260px;
    --sidebar-bg: #1a1a2e;
    --sidebar-text: #e0e0e0;
    --sidebar-accent: #667eea;
    --sidebar-hover: rgba(102, 126, 234, 0.15);
    --sidebar-active-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

   
  html {
    font-size: 15px;
  }

   
  .first-entry {
    min-height: 240px;
  }

  .first-entry .entry-header h1 {
    font-size: 24px;
  }

  .first-entry .entry-content {
    font-size: 14px;
  }

  .home-info .entry-content {
    font-size: 14px;
  }

  .entry-header h2 {
    font-size: 20px;
  }

  .entry-content {
    font-size: 13px;
  }

   
  .post-title,
  .post-single .post-title {
    font-size: 26px;
  }

  .post-content {
    font-size: 15px;
    line-height: 1.75;
  }

  .post-content h1 {
    font-size: 24px;
  }

  .post-content h2 {
    font-size: 21px;
  }

  .post-content h3 {
    font-size: 18px;
  }

  .post-content h4 {
    font-size: 16px;
  }

  .post-meta {
    font-size: 13px;
  }

  .toc a {
    font-size: 13px;
  }

  .first-entry {
    margin-top: 0;
  }

   
  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    width: var(--sidebar-width);
    height: 100vh;
    background: var(--sidebar-bg);
    color: var(--sidebar-text);
    z-index: 100;
    overflow-y: auto;
    transition: transform 0.3s ease;
  }

  .sidebar-inner {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 24px 0;
  }

  .sidebar-header {
    padding: 0 20px 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    margin-bottom: 8px;
  }

  .sidebar-logo {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 1.3rem;
    font-weight: 700;
    color: #fff;
    text-decoration: none;
    letter-spacing: -0.02em;
  }

  .sidebar-logo-img {
    width: 28px;
    height: 28px;
    border-radius: 6px;
    object-fit: cover;
  }

  .home-logo-img {
    width: 42px;
    height: 42px;
    border-radius: 8px;
    object-fit: cover;
    vertical-align: middle;
    margin-right: 8px;
  }

  .sidebar-logo:hover {
    opacity: 0.85;
  }

  .sidebar-subtitle {
    display: block;
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.4);
    margin-top: 2px;
    letter-spacing: 0.02em;
  }

   
  .sidebar-section ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .sidebar-section li a {
    display: block;
    padding: 9px 20px;
    color: var(--sidebar-text);
    text-decoration: none;
    font-size: 0.88rem;
    border-left: 3px solid transparent;
    transition: all 0.2s;
  }

  .sidebar-section li a:hover {
    background: var(--sidebar-hover);
    border-left-color: var(--sidebar-accent);
    color: #fff;
  }

  .sidebar-section li a.active {
    color: var(--sidebar-accent);
    font-weight: 600;
    border-left-color: var(--sidebar-accent);
  }

   
  .sidebar-section {
    padding: 8px 0;
    margin-top: 4px;
  }

  .sidebar-section-title {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: rgba(255, 255, 255, 0.4);
    padding: 8px 20px;
    margin: 0;
    font-weight: 600;
  }

  .sidebar-section li a {
    font-size: 0.82rem;
    padding: 7px 20px;
    line-height: 1.4;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

   
  .sidebar-stats {
    padding: 10px 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.08);
    margin-top: 4px;
    display: none;
    flex-direction: column;
    gap: 6px;
  }

  .sidebar-stat-pill {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 0 2px;
    height: 28px;
  }

  .stat-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .stat-dot--pv {
    background: #667eea;
  }

  .stat-dot--uv {
    background: #f5576c;
  }

  .sidebar-stat-value {
    font-weight: 600;
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.9);
    font-variant-numeric: tabular-nums;
  }

  .sidebar-stat-label {
    font-size: 0.7rem;
    color: rgba(255, 255, 255, 0.3);
  }

   
  .sidebar-dashboard-links {
    padding: 8px 20px;
    display: none;
    flex-direction: column;
    gap: 5px;
  }

  .sidebar-dashboard-links.visible {
    display: flex;
  }

  .sidebar-stats.visible {
    display: flex;
  }

  .sidebar-dashboard-links a {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 4px 10px;
    font-size: 0.7rem;
    white-space: nowrap;
    color: rgba(255, 255, 255, 0.5);
    text-decoration: none;
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    transition: all 0.2s;
  }

  .sidebar-dashboard-links a:hover {
    color: #fff;
    background: var(--sidebar-hover);
    border-color: var(--sidebar-accent);
  }

   
  .site-wrapper {
    margin-left: var(--sidebar-width);
    min-height: 100vh;
  }

   
  .sidebar-toggle {
    display: none;
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 101;
    background: var(--sidebar-active-bg);
    color: #fff;
    border: none;
    border-radius: 50%;
    width: 48px;
    height: 48px;
    cursor: pointer;
    box-shadow: 0 4px 14px rgba(102, 126, 234, 0.4);
    align-items: center;
    justify-content: center;
    transition: transform 0.2s;
  }

  .sidebar-toggle:hover {
    transform: scale(1.08);
  }

  .sidebar-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 99;
    backdrop-filter: blur(2px);
  }

   
  @media (max-width: 860px) {
    .sidebar {
      transform: translateX(-100%);
    }

    .sidebar.open {
      transform: translateX(0);
    }

    .sidebar-toggle {
      display: flex;
    }

    .sidebar-overlay.open {
      display: block;
    }

    .site-wrapper {
      margin-left: 0;
    }
  }
</style>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q0RS9ZG67P"></script>
      <script>
        var doNotTrack = false;
        if ( true ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-Q0RS9ZG67P');
        }
      </script><meta property="og:url" content="https://biz-agentic-ai.github.io/guides/etl-design/001-medallion-architecture/">
  <meta property="og:site_name" content="Junho Lee | DataNexus 구축 과정">
  <meta property="og:title" content="1. 메달리온 아키텍처 - 데이터를 세 겹으로 쌓는 이유">
  <meta property="og:description" content="Bronze, Silver, Gold. 데이터를 레이어별로 나눠서 적재하면 뭐가 달라지는가. DuckDB와 dbt로 직접 구성해 본다.">
  <meta property="og:locale" content="ko">
  <meta property="og:type" content="article">
    <meta property="article:section" content="guides">
    <meta property="article:published_time" content="2026-02-22T10:00:00+09:00">
    <meta property="article:modified_time" content="2026-02-22T10:00:00+09:00">
    <meta property="article:tag" content="Etl">
    <meta property="article:tag" content="Medallion-Architecture">
    <meta property="article:tag" content="Elt">
      <meta property="og:see_also" content="https://biz-agentic-ai.github.io/guides/etl-design/004-scd/">
      <meta property="og:see_also" content="https://biz-agentic-ai.github.io/guides/etl-design/003-silver-layer/">
      <meta property="og:see_also" content="https://biz-agentic-ai.github.io/guides/etl-design/002-bronze-layer/">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="1. 메달리온 아키텍처 - 데이터를 세 겹으로 쌓는 이유">
<meta name="twitter:description" content="Bronze, Silver, Gold. 데이터를 레이어별로 나눠서 적재하면 뭐가 달라지는가. DuckDB와 dbt로 직접 구성해 본다.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "기술 가이드",
      "item": "https://biz-agentic-ai.github.io/guides/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ETL 설계",
      "item": "https://biz-agentic-ai.github.io/guides/etl-design/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "1. 메달리온 아키텍처 - 데이터를 세 겹으로 쌓는 이유",
      "item": "https://biz-agentic-ai.github.io/guides/etl-design/001-medallion-architecture/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "1. 메달리온 아키텍처 - 데이터를 세 겹으로 쌓는 이유",
  "name": "1. 메달리온 아키텍처 - 데이터를 세 겹으로 쌓는 이유",
  "description": "Bronze, Silver, Gold. 데이터를 레이어별로 나눠서 적재하면 뭐가 달라지는가. DuckDB와 dbt로 직접 구성해 본다.",
  "keywords": [
    "etl", "medallion-architecture", "elt"
  ],
  "articleBody": "\rGoogle Colab에서 실습하기\r데이터 레이크가 늪이 되는 과정 데이터 레이크에 파일을 쏟아놓고 바로 분석하려는 팀이 있다. 처음엔 빠르다. CSV 올리고 SQL 한 줄이면 결과가 나온다.\n3개월 지나면 상황이 달라진다. 누가 올린 파일인지 모른다. 원본인지 정제된 건지 구분이 안 된다. 같은 매출 테이블인데 부서마다 숫자가 다르다. 데이터 늪(data swamp)이라고 부르는 상태다.\n원인은 단순하다. 원본과 가공물이 같은 공간에 섞여 있기 때문이다. 레이어를 나누면 이 문제가 풀린다.\nBronze, Silver, Gold 메달리온 아키텍처는 데이터를 세 개의 레이어로 나눈다. Databricks가 이름을 붙여서 널리 퍼졌지만, 개념 자체는 전통 DW의 레이어드 접근과 같다.\n소스 시스템 → [Bronze] → [Silver] → [Gold] → BI / 분석 원본 적재 정제·표준화 비즈니스 집계 Bronze 는 원본 그대로다. 소스 시스템에서 가져온 데이터를 변환 없이 저장한다. CSV든 JSON이든 API 응답이든 있는 그대로. 데이터 계보(lineage)의 출발점이다. 여기서 뭔가를 바꾸면 원본을 잃는다.\nSilver 는 정제와 표준화다. Bronze 데이터의 타입을 맞추고, 중복을 제거하고, 키를 통합한다. “분석에 쓸 수 있는 상태\"로 만드는 레이어다. 비즈니스 로직은 아직 넣지 않는다.\nGold 는 비즈니스 관점의 집계다. 팩트 테이블, 차원 테이블, KPI 마트. 최종 사용자가 직접 쿼리하는 레이어다. DW 모델링 1편에서 다뤘던 스타스키마가 여기에 해당한다.\n각 레이어의 역할이 명확하다는 게 핵심이다. Bronze에서는 절대 변환하지 않는다. Silver에서는 비즈니스 로직을 넣지 않는다. Gold에서만 비즈니스 관점의 가공이 들어간다. 이 규칙이 깨지면 레이어를 나눈 의미가 없다.\n전통 DW 레이어와의 대응 DW 모델링 시리즈에서 Raw → Staging → Integration → Mart 구조를 다뤘다. 메달리온과 이름만 다르고 역할은 거의 같다.\n메달리온 전통 DW 하는 일 Bronze Raw / Staging 원본 적재, 변환 없음 Silver Integration (3NF / Data Vault) 정제, 표준화, 키 통합 Gold Mart (Star Schema) 비즈니스 집계, 분석용 전통 DW에서는 Staging과 Integration 사이에 ETL 서버가 무거운 변환을 처리했다. 메달리온은 ELT 패러다임이다. 일단 Bronze에 적재하고, DW 엔진 안에서 Silver와 Gold를 만든다. 변환을 별도 서버가 아니라 DW 엔진의 컴퓨팅 파워로 처리한다는 점이 다르다.\n이 시리즈의 실습 환경 시리즈 전체에서 사용할 도구는 세 가지다. 전부 무료이고, Google Colab에서 클라우드 계정 없이 바로 돌릴 수 있다.\n도구 역할 DuckDB 로컬 DW 엔진. Columnar Storage 기반이라 BigQuery/Snowflake와 같은 방식으로 동작한다 dbt-core + dbt-duckdb 변환 레이어. SQL로 Bronze → Silver → Gold를 정의한다 Soda Core 데이터 품질 검증. 레이어 간 품질 게이트를 건다 DuckDB를 고른 이유가 있다. 설치가 pip install 한 줄이면서, 실제 클라우드 DW와 동작 방식이 같다. Parquet, CSV를 네이티브로 읽고, SQL로 분석하고, Columnar Storage라 컬럼 기반 스캔이 된다. 로컬에서 돌리지만 클라우드 DW의 축소판이라고 보면 된다.\n환경 세팅 Colab 셀에서 아래를 실행하면 준비 끝이다.\n# 도구 설치 !pip install -q duckdb dbt-core dbt-duckdb import duckdb # DuckDB 데이터베이스 생성 conn = duckdb.connect('warehouse.duckdb') print(f\"DuckDB {duckdb.__version__} 준비 완료\") 샘플 데이터 준비 시리즈에서 사용할 샘플은 간단한 이커머스 데이터다. 주문, 고객, 상품 세 테이블. DW 모델링 2편에서 다뤘던 구조와 같은 도메인이다.\n# Bronze 레이어: 원본 그대로 적재 conn.execute(\"\"\" CREATE SCHEMA IF NOT EXISTS bronze; CREATE OR REPLACE TABLE bronze.orders AS SELECT * FROM read_csv_auto('https://raw.githubusercontent.com/ dbt-labs/jaffle_shop/main/seeds/raw_orders.csv'); CREATE OR REPLACE TABLE bronze.customers AS SELECT * FROM read_csv_auto('https://raw.githubusercontent.com/ dbt-labs/jaffle_shop/main/seeds/raw_customers.csv'); CREATE OR REPLACE TABLE bronze.payments AS SELECT * FROM read_csv_auto('https://raw.githubusercontent.com/ dbt-labs/jaffle_shop/main/seeds/raw_payments.csv'); \"\"\") # 적재 확인 conn.execute(\"SELECT count(*) as cnt FROM bronze.orders\").fetchdf() Bronze에 적재했다. CSV를 읽어서 DuckDB에 넣었을 뿐, 어떤 변환도 하지 않았다. 타입 캐스팅도 안 했고, 컬럼명도 바꾸지 않았다. 이게 Bronze의 원칙이다.\n# Bronze 데이터 확인 conn.execute(\"SELECT * FROM bronze.orders LIMIT 5\").fetchdf() 여기서 바로 분석 쿼리를 던지고 싶은 유혹이 생긴다. 참아야 한다. Bronze 데이터를 직접 분석에 쓰면 3개월 뒤에 데이터 늪에 빠진다. 다음 글에서 Bronze를 Silver로 올리는 과정을 다룬다.\n왜 이렇게까지 나누는가 레이어를 나누면 느려지지 않냐는 질문을 받는다. 저장 공간도 더 쓰고, 변환 단계도 늘어나니까.\n맞다. 대신 세 가지를 얻는다.\n재처리가 가능하다. Silver 로직에 버그가 있으면 Bronze에서 다시 만들면 된다. 원본이 살아있으니까. Bronze 없이 Silver만 있으면 소스 시스템에서 다시 끌어와야 한다.\n문제 추적이 된다. Gold의 숫자가 이상하면 Silver를 보고, Silver가 이상하면 Bronze를 본다. 어느 레이어에서 문제가 생겼는지 특정할 수 있다.\n역할이 분리된다. 데이터 엔지니어는 Bronze→Silver를 책임지고, 분석 엔지니어는 Silver→Gold를 책임진다. 서로의 영역을 건드리지 않아도 된다.\n클라우드 환경에서 스토리지 비용은 거의 무시할 수 있는 수준이다. 레이어를 하나 더 두는 비용보다, 데이터 늪에 빠졌을 때의 비용이 훨씬 크다.\n실무 참고: Airflow DAG 이 시리즈의 실습은 Colab + dbt로 진행하지만, 실무에서는 Airflow가 파이프라인을 스케줄링하고 오케스트레이션한다. 메달리온 아키텍처의 Bronze → Silver → Gold 흐름을 Airflow DAG으로 짜면 이런 모양이다.\nfrom airflow import DAG from airflow.operators.bash import BashOperator from datetime import datetime with DAG( dag_id='medallion_pipeline', schedule='0 6 * * *', # 매일 오전 6시 start_date=datetime(2026, 1, 1), catchup=False, ) as dag: bronze = BashOperator( task_id='load_bronze', bash_command='python scripts/load_bronze.py', ) silver = BashOperator( task_id='run_silver', bash_command='cd dbt_project \u0026\u0026 dbt run --select staging', ) gold = BashOperator( task_id='run_gold', bash_command='cd dbt_project \u0026\u0026 dbt run --select marts', ) bronze \u003e\u003e silver \u003e\u003e gold bronze \u003e\u003e silver \u003e\u003e gold. 의존 관계가 한 줄로 읽힌다. Bronze 적재가 끝나야 Silver가 돌고, Silver가 끝나야 Gold가 돈다. Airflow가 이 순서를 보장하고, 실패하면 알림을 보내고, 재실행도 처리한다.\ndbt는 “무엇을 변환할지\"를 정의하고, Airflow는 “언제, 어떤 순서로 실행할지\"를 정의한다. 역할이 다르다.\n다음 글에서는 Bronze 레이어를 본격적으로 다룬다. Full Load와 Incremental Load의 차이, 증분 적재의 기준 컬럼을 어떻게 잡는지.\nGoogle Colab에서 실습하기\r",
  "wordCount" : "795",
  "inLanguage": "en",
  "datePublished": "2026-02-22T10:00:00+09:00",
  "dateModified": "2026-02-22T10:00:00+09:00",
  "author":{
    "@type": "Person",
    "name": "Junho Lee"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://biz-agentic-ai.github.io/guides/etl-design/001-medallion-architecture/"
  },
  "publisher": {
    "@type": "Person",
    "name": "Junho Lee | DataNexus 구축 과정",
    "logo": {
      "@type": "ImageObject",
      "url": "https://biz-agentic-ai.github.io/favicon.svg"
    }
  }
}
</script>
</head>

<body class="" id="top"><script data-goatcounter="https://biz-agentic-ai.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<aside class="sidebar" id="sidebar">
  <div class="sidebar-inner"><div class="sidebar-header">
      <a href="https://biz-agentic-ai.github.io/" class="sidebar-logo">
        <img src="/images/DataNexus_Logo.jpg" alt="DataNexus" class="sidebar-logo-img">
        DataNexus
      </a>
      <span class="sidebar-subtitle">구축 과정</span>
    </div>
    <div class="sidebar-section">
      <h3 class="sidebar-section-title">DataNexus Series</h3>
      <ul>
        <li>
          <a href="https://biz-agentic-ai.github.io/posts/datanexus/004-skos-compatibility-layer/" title="4. SKOS 호환 레이어를 왜 넣었는가" >
            4. SKOS 호환 레이어를 왜 넣었는가
          </a>
        </li>
        <li>
          <a href="https://biz-agentic-ai.github.io/posts/datanexus/003-datahub-glossary-as-ontology/" title="3. DataHub Glossary를 온톨로지로 쓸 수 있을까" >
            3. DataHub Glossary를 온톨로지로 쓸 수 있을까
          </a>
        </li>
        <li>
          <a href="https://biz-agentic-ai.github.io/posts/datanexus/002-architecture-decisions/" title="2. 4개의 오픈소스를 이 조합으로 결정하기까지" >
            2. 4개의 오픈소스를 이 조합으로 결정하기까지
          </a>
        </li>
        <li>
          <a href="https://biz-agentic-ai.github.io/posts/datanexus/001-why-datanexus/" title="1. 왜 DataNexus를 만드는가" >
            1. 왜 DataNexus를 만드는가
          </a>
        </li>
      </ul>
    </div><div class="sidebar-stats" id="sidebar-stats">
      <div class="sidebar-stat-pill" id="gc-container-pv" style="display:none;">
        <span class="stat-dot stat-dot--pv"></span>
        <span class="sidebar-stat-value" id="gc-value-pv">-</span>
        <span class="sidebar-stat-label">views</span>
      </div>
      <div class="sidebar-stat-pill" id="gc-container-uv" style="display:none;">
        <span class="stat-dot stat-dot--uv"></span>
        <span class="sidebar-stat-value" id="gc-value-uv">-</span>
        <span class="sidebar-stat-label">visitors</span>
      </div>
    </div>
    <script>
      (function () {
        var p = encodeURIComponent(location.pathname);
        fetch('https://biz-agentic-ai.goatcounter.com/counter/' + p + '.json')
          .then(function (r) { return r.json(); })
          .then(function (d) {
            if (d.count) {
              document.getElementById('gc-value-pv').textContent = d.count;
              document.getElementById('gc-container-pv').style.display = '';
            }
            if (d.count_unique) {
              document.getElementById('gc-value-uv').textContent = d.count_unique;
              document.getElementById('gc-container-uv').style.display = '';
            }
          })
          .catch(function () { });
      })();
    </script><div class="sidebar-dashboard-links" id="dashboard-links">
      <a href="https://biz-agentic-ai.goatcounter.com/" target="_blank" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="20" x2="18" y2="10"></line>
          <line x1="12" y1="20" x2="12" y2="4"></line>
          <line x1="6" y1="20" x2="6" y2="14"></line>
        </svg>
        GoatCounter
      </a>
      <a href="https://analytics.google.com/analytics/web/" target="_blank" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path>
          <path d="M22 12A10 10 0 0 0 12 2v10z"></path>
        </svg>
        GA4 Dashboard
      </a>
    </div>
    <script>
      (function () {
        var el = document.getElementById('dashboard-links');
        var stats = document.getElementById('sidebar-stats');
        if (localStorage.getItem('dn-admin')) {
          el.classList.add('visible');
          stats.classList.add('visible');
        }
        document.querySelector('.sidebar-logo').addEventListener('dblclick', function () {
          var on = localStorage.getItem('dn-admin');
          if (on) {
            localStorage.removeItem('dn-admin');
            el.classList.remove('visible');
            stats.classList.remove('visible');
          } else {
            localStorage.setItem('dn-admin', '1');
            el.classList.add('visible');
            stats.classList.add('visible');
          }
        });
      })();
    </script>

  </div>
</aside><button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
  <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <line x1="3" y1="12" x2="21" y2="12"></line>
    <line x1="3" y1="6" x2="21" y2="6"></line>
    <line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</button>
<div class="sidebar-overlay" id="sidebar-overlay"></div><div class="site-wrapper">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://biz-agentic-ai.github.io/" accesskey="h" title="Junho Lee | DataNexus 구축 과정 (Alt + H)">Junho Lee | DataNexus 구축 과정</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://biz-agentic-ai.github.io/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://biz-agentic-ai.github.io/guides/" title="Guides">
                    <span>Guides</span>
                </a>
            </li>
            <li>
                <a href="https://biz-agentic-ai.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://biz-agentic-ai.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://biz-agentic-ai.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://biz-agentic-ai.github.io/">홈</a>&nbsp;»&nbsp;<a href="https://biz-agentic-ai.github.io/guides/">기술 가이드</a>&nbsp;»&nbsp;<a href="https://biz-agentic-ai.github.io/guides/etl-design/">ETL 설계</a></div>
    <h1 class="post-title entry-hint-parent">
      1. 메달리온 아키텍처 - 데이터를 세 겹으로 쌓는 이유
    </h1>
    <div class="post-meta"><span title='2026-02-22 10:00:00 +0900 KST'>February 22, 2026</span>&nbsp;·&nbsp;4 분&nbsp;·&nbsp;Junho Lee

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">목차</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%eb%8d%b0%ec%9d%b4%ed%84%b0-%eb%a0%88%ec%9d%b4%ed%81%ac%ea%b0%80-%eb%8a%aa%ec%9d%b4-%eb%90%98%eb%8a%94-%ea%b3%bc%ec%a0%95" aria-label="데이터 레이크가 늪이 되는 과정">데이터 레이크가 늪이 되는 과정</a></li>
                <li>
                    <a href="#bronze-silver-gold" aria-label="Bronze, Silver, Gold">Bronze, Silver, Gold</a></li>
                <li>
                    <a href="#%ec%a0%84%ed%86%b5-dw-%eb%a0%88%ec%9d%b4%ec%96%b4%ec%99%80%ec%9d%98-%eb%8c%80%ec%9d%91" aria-label="전통 DW 레이어와의 대응">전통 DW 레이어와의 대응</a></li>
                <li>
                    <a href="#%ec%9d%b4-%ec%8b%9c%eb%a6%ac%ec%a6%88%ec%9d%98-%ec%8b%a4%ec%8a%b5-%ed%99%98%ea%b2%bd" aria-label="이 시리즈의 실습 환경">이 시리즈의 실습 환경</a></li>
                <li>
                    <a href="#%ed%99%98%ea%b2%bd-%ec%84%b8%ed%8c%85" aria-label="환경 세팅">환경 세팅</a></li>
                <li>
                    <a href="#%ec%83%98%ed%94%8c-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%a4%80%eb%b9%84" aria-label="샘플 데이터 준비">샘플 데이터 준비</a></li>
                <li>
                    <a href="#%ec%99%9c-%ec%9d%b4%eb%a0%87%ea%b2%8c%ea%b9%8c%ec%a7%80-%eb%82%98%eb%88%84%eb%8a%94%ea%b0%80" aria-label="왜 이렇게까지 나누는가">왜 이렇게까지 나누는가</a></li>
                <li>
                    <a href="#%ec%8b%a4%eb%ac%b4-%ec%b0%b8%ea%b3%a0-airflow-dag" aria-label="실무 참고: Airflow DAG">실무 참고: Airflow DAG</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><div style="margin: 1.2em 0;">
  <a href="https://colab.research.google.com/github/biz-agentic-ai/biz-agentic-ai.github.io/blob/main/notebooks/etl-001-medallion-architecture.ipynb" target="_blank" rel="noopener noreferrer"
     style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px;
            background: linear-gradient(135deg, #f9ab00 0%, #f57c00 100%);
            color: #fff; text-decoration: none; border-radius: 8px;
            font-weight: 600; font-size: 0.95em;
            box-shadow: 0 2px 8px rgba(245,124,0,0.25);
            transition: all 0.2s ease;">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="white"/>
    </svg>
    Google Colab에서 실습하기
  </a>
</div>

<h2 id="데이터-레이크가-늪이-되는-과정">데이터 레이크가 늪이 되는 과정<a hidden class="anchor" aria-hidden="true" href="#데이터-레이크가-늪이-되는-과정">#</a></h2>
<p>데이터 레이크에 파일을 쏟아놓고 바로 분석하려는 팀이 있다. 처음엔 빠르다. CSV 올리고 SQL 한 줄이면 결과가 나온다.</p>
<p>3개월 지나면 상황이 달라진다. 누가 올린 파일인지 모른다. 원본인지 정제된 건지 구분이 안 된다. 같은 매출 테이블인데 부서마다 숫자가 다르다. 데이터 늪(data swamp)이라고 부르는 상태다.</p>
<p>원인은 단순하다. 원본과 가공물이 같은 공간에 섞여 있기 때문이다. 레이어를 나누면 이 문제가 풀린다.</p>
<h2 id="bronze-silver-gold">Bronze, Silver, Gold<a hidden class="anchor" aria-hidden="true" href="#bronze-silver-gold">#</a></h2>
<p>메달리온 아키텍처는 데이터를 세 개의 레이어로 나눈다. Databricks가 이름을 붙여서 널리 퍼졌지만, 개념 자체는 전통 DW의 레이어드 접근과 같다.</p>
<div class="highlight"><pre tabindex="0" style="color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>소스 시스템 → [Bronze] → [Silver] → [Gold] → BI / 분석
</span></span><span style="display:flex;"><span>               원본 적재    정제·표준화   비즈니스 집계
</span></span></code></pre></div><p><strong>Bronze</strong> 는 원본 그대로다. 소스 시스템에서 가져온 데이터를 변환 없이 저장한다. CSV든 JSON이든 API 응답이든 있는 그대로. 데이터 계보(lineage)의 출발점이다. 여기서 뭔가를 바꾸면 원본을 잃는다.</p>
<p><strong>Silver</strong> 는 정제와 표준화다. Bronze 데이터의 타입을 맞추고, 중복을 제거하고, 키를 통합한다. &ldquo;분석에 쓸 수 있는 상태&quot;로 만드는 레이어다. 비즈니스 로직은 아직 넣지 않는다.</p>
<p><strong>Gold</strong> 는 비즈니스 관점의 집계다. 팩트 테이블, 차원 테이블, KPI 마트. 최종 사용자가 직접 쿼리하는 레이어다. <a href="https://biz-agentic-ai.github.io/guides/dw-modeling/001-cloud-era-dw-modeling/">DW 모델링 1편</a>에서 다뤘던 스타스키마가 여기에 해당한다.</p>
<p>각 레이어의 역할이 명확하다는 게 핵심이다. Bronze에서는 절대 변환하지 않는다. Silver에서는 비즈니스 로직을 넣지 않는다. Gold에서만 비즈니스 관점의 가공이 들어간다. 이 규칙이 깨지면 레이어를 나눈 의미가 없다.</p>
<h2 id="전통-dw-레이어와의-대응">전통 DW 레이어와의 대응<a hidden class="anchor" aria-hidden="true" href="#전통-dw-레이어와의-대응">#</a></h2>
<p><a href="https://biz-agentic-ai.github.io/guides/dw-modeling/001-cloud-era-dw-modeling/">DW 모델링 시리즈</a>에서 <code>Raw → Staging → Integration → Mart</code> 구조를 다뤘다. 메달리온과 이름만 다르고 역할은 거의 같다.</p>
<table>
  <thead>
      <tr>
          <th>메달리온</th>
          <th>전통 DW</th>
          <th>하는 일</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Bronze</td>
          <td>Raw / Staging</td>
          <td>원본 적재, 변환 없음</td>
      </tr>
      <tr>
          <td>Silver</td>
          <td>Integration (3NF / Data Vault)</td>
          <td>정제, 표준화, 키 통합</td>
      </tr>
      <tr>
          <td>Gold</td>
          <td>Mart (Star Schema)</td>
          <td>비즈니스 집계, 분석용</td>
      </tr>
  </tbody>
</table>
<p>전통 DW에서는 Staging과 Integration 사이에 ETL 서버가 무거운 변환을 처리했다. 메달리온은 ELT 패러다임이다. 일단 Bronze에 적재하고, DW 엔진 안에서 Silver와 Gold를 만든다. 변환을 별도 서버가 아니라 DW 엔진의 컴퓨팅 파워로 처리한다는 점이 다르다.</p>
<h2 id="이-시리즈의-실습-환경">이 시리즈의 실습 환경<a hidden class="anchor" aria-hidden="true" href="#이-시리즈의-실습-환경">#</a></h2>
<p>시리즈 전체에서 사용할 도구는 세 가지다. 전부 무료이고, Google Colab에서 클라우드 계정 없이 바로 돌릴 수 있다.</p>
<table>
  <thead>
      <tr>
          <th>도구</th>
          <th>역할</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>DuckDB</td>
          <td>로컬 DW 엔진. Columnar Storage 기반이라 BigQuery/Snowflake와 같은 방식으로 동작한다</td>
      </tr>
      <tr>
          <td>dbt-core + dbt-duckdb</td>
          <td>변환 레이어. SQL로 Bronze → Silver → Gold를 정의한다</td>
      </tr>
      <tr>
          <td>Soda Core</td>
          <td>데이터 품질 검증. 레이어 간 품질 게이트를 건다</td>
      </tr>
  </tbody>
</table>
<p>DuckDB를 고른 이유가 있다. 설치가 <code>pip install</code> 한 줄이면서, 실제 클라우드 DW와 동작 방식이 같다. Parquet, CSV를 네이티브로 읽고, SQL로 분석하고, Columnar Storage라 컬럼 기반 스캔이 된다. 로컬에서 돌리지만 클라우드 DW의 축소판이라고 보면 된다.</p>
<h2 id="환경-세팅">환경 세팅<a hidden class="anchor" aria-hidden="true" href="#환경-세팅">#</a></h2>
<p>Colab 셀에서 아래를 실행하면 준비 끝이다.</p>
<div class="highlight"><pre tabindex="0" style="color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#414868;font-style:italic"># 도구 설치</span>
</span></span><span style="display:flex;"><span><span style="color:#db4b4b">!</span>pip install <span style="color:#9ece6a;font-weight:bold">-</span>q duckdb dbt<span style="color:#9ece6a;font-weight:bold">-</span>core dbt<span style="color:#9ece6a;font-weight:bold">-</span>duckdb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7dcfff">import</span> <span style="color:#e0af68">duckdb</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#414868;font-style:italic"># DuckDB 데이터베이스 생성</span>
</span></span><span style="display:flex;"><span>conn <span style="color:#9ece6a;font-weight:bold">=</span> duckdb<span style="color:#9ece6a;font-weight:bold">.</span>connect(<span style="color:#9ece6a">&#39;warehouse.duckdb&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#9ece6a">print</span>(<span style="color:#9d7cd8">f</span><span style="color:#9ece6a">&#34;DuckDB </span><span style="color:#9ece6a">{</span>duckdb<span style="color:#9ece6a;font-weight:bold">.</span>__version__<span style="color:#9ece6a">}</span><span style="color:#9ece6a"> 준비 완료&#34;</span>)
</span></span></code></pre></div><h2 id="샘플-데이터-준비">샘플 데이터 준비<a hidden class="anchor" aria-hidden="true" href="#샘플-데이터-준비">#</a></h2>
<p>시리즈에서 사용할 샘플은 간단한 이커머스 데이터다. 주문, 고객, 상품 세 테이블. <a href="https://biz-agentic-ai.github.io/guides/dw-modeling/002-oltp-vs-dw-model/">DW 모델링 2편</a>에서 다뤘던 구조와 같은 도메인이다.</p>
<div class="highlight"><pre tabindex="0" style="color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#414868;font-style:italic"># Bronze 레이어: 원본 그대로 적재</span>
</span></span><span style="display:flex;"><span>conn<span style="color:#9ece6a;font-weight:bold">.</span>execute(<span style="color:#9ece6a">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">CREATE SCHEMA IF NOT EXISTS bronze;
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">CREATE OR REPLACE TABLE bronze.orders AS
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">SELECT * FROM read_csv_auto(&#39;https://raw.githubusercontent.com/
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">  dbt-labs/jaffle_shop/main/seeds/raw_orders.csv&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">CREATE OR REPLACE TABLE bronze.customers AS
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">SELECT * FROM read_csv_auto(&#39;https://raw.githubusercontent.com/
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">  dbt-labs/jaffle_shop/main/seeds/raw_customers.csv&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">CREATE OR REPLACE TABLE bronze.payments AS
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">SELECT * FROM read_csv_auto(&#39;https://raw.githubusercontent.com/
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">  dbt-labs/jaffle_shop/main/seeds/raw_payments.csv&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#9ece6a">&#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#414868;font-style:italic"># 적재 확인</span>
</span></span><span style="display:flex;"><span>conn<span style="color:#9ece6a;font-weight:bold">.</span>execute(<span style="color:#9ece6a">&#34;SELECT count(*) as cnt FROM bronze.orders&#34;</span>)<span style="color:#9ece6a;font-weight:bold">.</span>fetchdf()
</span></span></code></pre></div><p>Bronze에 적재했다. CSV를 읽어서 DuckDB에 넣었을 뿐, 어떤 변환도 하지 않았다. 타입 캐스팅도 안 했고, 컬럼명도 바꾸지 않았다. 이게 Bronze의 원칙이다.</p>
<div class="highlight"><pre tabindex="0" style="color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#414868;font-style:italic"># Bronze 데이터 확인</span>
</span></span><span style="display:flex;"><span>conn<span style="color:#9ece6a;font-weight:bold">.</span>execute(<span style="color:#9ece6a">&#34;SELECT * FROM bronze.orders LIMIT 5&#34;</span>)<span style="color:#9ece6a;font-weight:bold">.</span>fetchdf()
</span></span></code></pre></div><p>여기서 바로 분석 쿼리를 던지고 싶은 유혹이 생긴다. 참아야 한다. Bronze 데이터를 직접 분석에 쓰면 3개월 뒤에 데이터 늪에 빠진다. 다음 글에서 Bronze를 Silver로 올리는 과정을 다룬다.</p>
<h2 id="왜-이렇게까지-나누는가">왜 이렇게까지 나누는가<a hidden class="anchor" aria-hidden="true" href="#왜-이렇게까지-나누는가">#</a></h2>
<p>레이어를 나누면 느려지지 않냐는 질문을 받는다. 저장 공간도 더 쓰고, 변환 단계도 늘어나니까.</p>
<p>맞다. 대신 세 가지를 얻는다.</p>
<p><strong>재처리가 가능하다.</strong> Silver 로직에 버그가 있으면 Bronze에서 다시 만들면 된다. 원본이 살아있으니까. Bronze 없이 Silver만 있으면 소스 시스템에서 다시 끌어와야 한다.</p>
<p><strong>문제 추적이 된다.</strong> Gold의 숫자가 이상하면 Silver를 보고, Silver가 이상하면 Bronze를 본다. 어느 레이어에서 문제가 생겼는지 특정할 수 있다.</p>
<p><strong>역할이 분리된다.</strong> 데이터 엔지니어는 Bronze→Silver를 책임지고, 분석 엔지니어는 Silver→Gold를 책임진다. 서로의 영역을 건드리지 않아도 된다.</p>
<p>클라우드 환경에서 스토리지 비용은 거의 무시할 수 있는 수준이다. 레이어를 하나 더 두는 비용보다, 데이터 늪에 빠졌을 때의 비용이 훨씬 크다.</p>
<h2 id="실무-참고-airflow-dag">실무 참고: Airflow DAG<a hidden class="anchor" aria-hidden="true" href="#실무-참고-airflow-dag">#</a></h2>
<p>이 시리즈의 실습은 Colab + dbt로 진행하지만, 실무에서는 Airflow가 파이프라인을 스케줄링하고 오케스트레이션한다. 메달리온 아키텍처의 Bronze → Silver → Gold 흐름을 Airflow DAG으로 짜면 이런 모양이다.</p>
<div class="highlight"><pre tabindex="0" style="color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#7dcfff">from</span> <span style="color:#e0af68">airflow</span> <span style="color:#7dcfff">import</span> DAG
</span></span><span style="display:flex;"><span><span style="color:#7dcfff">from</span> <span style="color:#e0af68">airflow.operators.bash</span> <span style="color:#7dcfff">import</span> BashOperator
</span></span><span style="display:flex;"><span><span style="color:#7dcfff">from</span> <span style="color:#e0af68">datetime</span> <span style="color:#7dcfff">import</span> datetime
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bb9af7">with</span> DAG(
</span></span><span style="display:flex;"><span>    dag_id<span style="color:#9ece6a;font-weight:bold">=</span><span style="color:#9ece6a">&#39;medallion_pipeline&#39;</span>,
</span></span><span style="display:flex;"><span>    schedule<span style="color:#9ece6a;font-weight:bold">=</span><span style="color:#9ece6a">&#39;0 6 * * *&#39;</span>,  <span style="color:#414868;font-style:italic"># 매일 오전 6시</span>
</span></span><span style="display:flex;"><span>    start_date<span style="color:#9ece6a;font-weight:bold">=</span>datetime(<span style="color:#e0af68">2026</span>, <span style="color:#e0af68">1</span>, <span style="color:#e0af68">1</span>),
</span></span><span style="display:flex;"><span>    catchup<span style="color:#9ece6a;font-weight:bold">=</span><span style="color:#e0af68">False</span>,
</span></span><span style="display:flex;"><span>) <span style="color:#bb9af7">as</span> dag:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    bronze <span style="color:#9ece6a;font-weight:bold">=</span> BashOperator(
</span></span><span style="display:flex;"><span>        task_id<span style="color:#9ece6a;font-weight:bold">=</span><span style="color:#9ece6a">&#39;load_bronze&#39;</span>,
</span></span><span style="display:flex;"><span>        bash_command<span style="color:#9ece6a;font-weight:bold">=</span><span style="color:#9ece6a">&#39;python scripts/load_bronze.py&#39;</span>,
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    silver <span style="color:#9ece6a;font-weight:bold">=</span> BashOperator(
</span></span><span style="display:flex;"><span>        task_id<span style="color:#9ece6a;font-weight:bold">=</span><span style="color:#9ece6a">&#39;run_silver&#39;</span>,
</span></span><span style="display:flex;"><span>        bash_command<span style="color:#9ece6a;font-weight:bold">=</span><span style="color:#9ece6a">&#39;cd dbt_project &amp;&amp; dbt run --select staging&#39;</span>,
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    gold <span style="color:#9ece6a;font-weight:bold">=</span> BashOperator(
</span></span><span style="display:flex;"><span>        task_id<span style="color:#9ece6a;font-weight:bold">=</span><span style="color:#9ece6a">&#39;run_gold&#39;</span>,
</span></span><span style="display:flex;"><span>        bash_command<span style="color:#9ece6a;font-weight:bold">=</span><span style="color:#9ece6a">&#39;cd dbt_project &amp;&amp; dbt run --select marts&#39;</span>,
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    bronze <span style="color:#9ece6a;font-weight:bold">&gt;&gt;</span> silver <span style="color:#9ece6a;font-weight:bold">&gt;&gt;</span> gold
</span></span></code></pre></div><p><code>bronze &gt;&gt; silver &gt;&gt; gold</code>. 의존 관계가 한 줄로 읽힌다. Bronze 적재가 끝나야 Silver가 돌고, Silver가 끝나야 Gold가 돈다. Airflow가 이 순서를 보장하고, 실패하면 알림을 보내고, 재실행도 처리한다.</p>
<p>dbt는 &ldquo;무엇을 변환할지&quot;를 정의하고, Airflow는 &ldquo;언제, 어떤 순서로 실행할지&quot;를 정의한다. 역할이 다르다.</p>
<p>다음 글에서는 Bronze 레이어를 본격적으로 다룬다. Full Load와 Incremental Load의 차이, 증분 적재의 기준 컬럼을 어떻게 잡는지.</p>
<div style="margin: 1.2em 0;">
  <a href="https://colab.research.google.com/github/biz-agentic-ai/biz-agentic-ai.github.io/blob/main/notebooks/etl-001-medallion-architecture.ipynb" target="_blank" rel="noopener noreferrer"
     style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px;
            background: linear-gradient(135deg, #f9ab00 0%, #f57c00 100%);
            color: #fff; text-decoration: none; border-radius: 8px;
            font-weight: 600; font-size: 0.95em;
            box-shadow: 0 2px 8px rgba(245,124,0,0.25);
            transition: all 0.2s ease;">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="white"/>
    </svg>
    Google Colab에서 실습하기
  </a>
</div>



  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://biz-agentic-ai.github.io/tags/etl/">Etl</a></li>
      <li><a href="https://biz-agentic-ai.github.io/tags/medallion-architecture/">Medallion-Architecture</a></li>
      <li><a href="https://biz-agentic-ai.github.io/tags/elt/">Elt</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://biz-agentic-ai.github.io/guides/dw-modeling/004-super-sub-type/">
    <span class="title">« 이전 페이지</span>
    <br>
    <span>4. 수퍼-서브 타입 - 고객이 개인이면서 법인일 수 있는가</span>
  </a>
  <a class="next" href="https://biz-agentic-ai.github.io/guides/etl-design/002-bronze-layer/">
    <span class="title">다음 페이지 »</span>
    <br>
    <span>2. Bronze 레이어 - 원본을 있는 그대로 쌓는다</span>
  </a>
</nav>

  </footer>
<div class="comments">
  <script src="https://giscus.app/client.js"
    data-repo="biz-agentic-ai/biz-agentic-ai.github.io"
    data-repo-id="R_kgDOPhm8OQ"
    data-category="General"
    data-category-id="DIC_kwDOPhm8Oc4C2uES"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="ko"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>
</div>

</article>
        </main>
        
<footer class="footer">
        <span>&copy; 2026 <a href="https://biz-agentic-ai.github.io/">Junho Lee | DataNexus 구축 과정</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '복사';

        function copyingDone() {
            copybutton.innerHTML = '복사 완료!';
            setTimeout(() => {
                copybutton.innerHTML = '복사';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</div>
    <script>
    (function() {
        const toggle = document.getElementById('sidebar-toggle');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        if (toggle && sidebar) {
            toggle.addEventListener('click', function() {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('open');
            });
            overlay.addEventListener('click', function() {
                sidebar.classList.remove('open');
                overlay.classList.remove('open');
            });
        }
    })();
    </script>
</body>

</html>
